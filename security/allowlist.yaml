# ğŸ›¡ï¸ å®‰å…¨æ¼æ´ç™½åå•
# è®°å½•å·²è¯„ä¼°å¹¶æ¥å—çš„å®‰å…¨æ¼æ´ï¼ŒåŒ…å«åˆ°æœŸæ—¶é—´å’Œè±å…ç†ç”±

version: "1.0"
last_updated: "2025-08-19"
maintainer: "DevOps Team"

# æ¼æ´ç™½åå•
allowlist:
  # setuptoolsç›¸å…³æ¼æ´
  - id: "CVE-2024-6345"
    package: "setuptools"
    version: "65.5.1"
    severity: "HIGH"
    reason: "è¿œç¨‹ä»£ç æ‰§è¡Œæ¼æ´ï¼Œä½†åœ¨å®¹å™¨åŒ–ç¯å¢ƒä¸­é£é™©è¾ƒä½ï¼Œä¸”åº”ç”¨ä¸ä½¿ç”¨package_indexæ¨¡å—"
    risk_assessment: "LOW"
    mitigation: "å®¹å™¨åŒ–éƒ¨ç½²ï¼Œç½‘ç»œéš”ç¦»ï¼Œä¸ä½¿ç”¨ç›¸å…³åŠŸèƒ½æ¨¡å—"
    expires: "2025-10-01"
    reviewer: "Security Team"
    status: "approved"
    
  - id: "CVE-2025-47273"
    package: "setuptools"
    version: "65.5.1"
    severity: "HIGH"
    reason: "è·¯å¾„éå†æ¼æ´ï¼Œåº”ç”¨ä¸ä½¿ç”¨PackageIndexåŠŸèƒ½"
    risk_assessment: "LOW"
    mitigation: "åº”ç”¨ä¸ä½¿ç”¨setuptoolsçš„PackageIndexåŠŸèƒ½"
    expires: "2025-10-01"
    reviewer: "Security Team"
    status: "approved"
    
  # starletteç›¸å…³æ¼æ´
  - id: "CVE-2024-47874"
    package: "starlette"
    version: "0.37.2"
    severity: "HIGH"
    reason: "DoSæ¼æ´é€šè¿‡multipart/form-dataï¼Œç”Ÿäº§ç¯å¢ƒæœ‰è´Ÿè½½å‡è¡¡å’Œé™æµä¿æŠ¤"
    risk_assessment: "MEDIUM"
    mitigation: "è´Ÿè½½å‡è¡¡å™¨é™åˆ¶è¯·æ±‚å¤§å°ï¼Œåº”ç”¨å±‚æœ‰RequestSizeLimitMiddleware"
    expires: "2025-09-15"
    reviewer: "Security Team"
    status: "approved"
    upgrade_plan: "ç­‰å¾…starlette 0.40.0å…¼å®¹æ€§éªŒè¯"

# ç³»ç»Ÿçº§æ¼æ´ï¼ˆä»…è®°å½•ï¼Œä¸å½±å“éƒ¨ç½²ï¼‰
system_vulnerabilities:
  # curlç›¸å…³æ¼æ´
  - id: "CVE-2023-23914"
    package: "curl"
    severity: "CRITICAL"
    reason: "HSTSç»•è¿‡æ¼æ´ï¼Œåº”ç”¨ä¸ç›´æ¥ä½¿ç”¨curlè¿›è¡ŒHTTPSè¯·æ±‚"
    status: "will_not_fix"
    
  - id: "CVE-2022-42916"
    package: "curl"
    severity: "HIGH"
    reason: "HSTSç»•è¿‡æ¼æ´ï¼Œåº”ç”¨ä¸ä¾èµ–HSTSåŠŸèƒ½"
    status: "will_not_fix"
    
  # sqliteç›¸å…³æ¼æ´
  - id: "CVE-2025-6965"
    package: "libsqlite3-0"
    severity: "CRITICAL"
    reason: "æ•´æ•°æˆªæ–­æ¼æ´ï¼Œåº”ç”¨ä½¿ç”¨PostgreSQLï¼Œä¸ç›´æ¥ä½¿ç”¨SQLite"
    status: "fix_deferred"
    
  # zlibç›¸å…³æ¼æ´
  - id: "CVE-2023-45853"
    package: "zlib1g"
    severity: "CRITICAL"
    reason: "ZIPå¤„ç†æ¼æ´ï¼Œåº”ç”¨ä¸å¤„ç†ZIPæ–‡ä»¶"
    status: "will_not_fix"

# è±å…ç­–ç•¥
exemption_policies:
  # ç³»ç»Ÿçº§åŒ…è±å…ç­–ç•¥
  system_packages:
    - pattern: "curl*"
      reason: "åº”ç”¨ä¸ç›´æ¥ä½¿ç”¨curl"
      max_severity: "CRITICAL"
      
    - pattern: "libsqlite3*"
      reason: "åº”ç”¨ä½¿ç”¨PostgreSQLï¼Œä¸ä½¿ç”¨SQLite"
      max_severity: "CRITICAL"
      
    - pattern: "zlib*"
      reason: "åº”ç”¨ä¸å¤„ç†å‹ç¼©æ–‡ä»¶"
      max_severity: "HIGH"
      
  # PythonåŒ…è±å…ç­–ç•¥
  python_packages:
    - pattern: "setuptools"
      reason: "ä»…åœ¨æ„å»ºæ—¶ä½¿ç”¨ï¼Œè¿è¡Œæ—¶ä¸æš´éœ²ç›¸å…³åŠŸèƒ½"
      max_severity: "HIGH"
      requires_review: true
      
# å‡çº§è®¡åˆ’
upgrade_schedule:
  - package: "starlette"
    current_version: "0.37.2"
    target_version: "0.40.0"
    planned_date: "2025-09-01"
    blocker: "ç­‰å¾…FastAPIå…¼å®¹æ€§ç¡®è®¤"
    
  - package: "setuptools"
    current_version: "65.5.1"
    target_version: "78.1.1"
    planned_date: "2025-09-15"
    blocker: "éœ€è¦æµ‹è¯•æ„å»ºå…¼å®¹æ€§"

# ç›‘æ§å’Œå®¡æŸ¥
monitoring:
  review_frequency: "monthly"
  next_review: "2025-09-19"
  escalation_threshold: "7_days_before_expiry"
  
# è”ç³»ä¿¡æ¯
contacts:
  security_team: "security@company.com"
  devops_team: "devops@company.com"
  escalation: "cto@company.com"
