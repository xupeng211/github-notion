{
  "CloudWatchMetricsEnabled": true,
  "DefaultAction": {
    "Block": {}
  },
  "Description": "WAF rules for Gitee-Notion Sync application",
  "Name": "GiteeNotionSyncWAFRules",
  "Rules": [
    {
      "Action": {
        "Block": {}
      },
      "Name": "RateLimit",
      "Priority": 1,
      "Statement": {
        "RateBasedStatement": {
          "AggregateKeyType": "IP",
          "Limit": 2000
        }
      }
    },
    {
      "Action": {
        "Block": {}
      },
      "Name": "BlockBadBots",
      "Priority": 2,
      "Statement": {
        "ByteMatchStatement": {
          "FieldToMatch": {
            "SingleHeader": {
              "Name": "user-agent"
            }
          },
          "PositionalConstraint": "CONTAINS",
          "SearchString": "bad-bot",
          "TextTransformations": [
            {
              "Priority": 1,
              "Type": "LOWERCASE"
            }
          ]
        }
      }
    },
    {
      "Action": {
        "Block": {}
      },
      "Name": "BlockSQLInjection",
      "Priority": 3,
      "Statement": {
        "SqliMatchStatement": {
          "FieldToMatch": {
            "Body": {}
          },
          "TextTransformations": [
            {
              "Priority": 1,
              "Type": "URL_DECODE"
            },
            {
              "Priority": 2,
              "Type": "HTML_ENTITY_DECODE"
            }
          ]
        }
      }
    },
    {
      "Action": {
        "Block": {}
      },
      "Name": "BlockXSS",
      "Priority": 4,
      "Statement": {
        "XssMatchStatement": {
          "FieldToMatch": {
            "Body": {}
          },
          "TextTransformations": [
            {
              "Priority": 1,
              "Type": "URL_DECODE"
            },
            {
              "Priority": 2,
              "Type": "HTML_ENTITY_DECODE"
            }
          ]
        }
      }
    },
    {
      "Action": {
        "Allow": {}
      },
      "Name": "AllowOnlyWebhookEndpoints",
      "Priority": 5,
      "Statement": {
        "AndStatement": {
          "Statements": [
            {
              "ByteMatchStatement": {
                "FieldToMatch": {
                  "UriPath": {}
                },
                "PositionalConstraint": "EXACTLY",
                "SearchString": "/gitee_webhook",
                "TextTransformations": [
                  {
                    "Priority": 1,
                    "Type": "LOWERCASE"
                  }
                ]
              }
            },
            {
              "ByteMatchStatement": {
                "FieldToMatch": {
                  "UriPath": {}
                },
                "PositionalConstraint": "EXACTLY",
                "SearchString": "/notion_webhook",
                "TextTransformations": [
                  {
                    "Priority": 1,
                    "Type": "LOWERCASE"
                  }
                ]
              }
            }
          ]
        }
      }
    }
  ],
  "Scope": "REGIONAL"
}
